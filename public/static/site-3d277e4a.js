import{b as pe,aB as me,i as Z,s as fe,U as q,v as z,aC as M,ah as K,ag as G,aD as H,d as R,aE as ve,aF as _e,P as ge,aG as he,aH as ye,c as k,z as E,B as be,G as j,aI as Ve,I as we,o as d,f as I,g as S,h as e,n as C,a4 as Ce,k as b,w as n,l as A,E as D,m as V,t as J,j as o,aJ as Se,p as ee,aK as ke,_ as Ee,O as Ie,H as Te,aL as ae,aM as Ne,J as Ue,a0 as Be,a2 as xe,a3 as x,aN as P,a6 as F,av as te,aO as Pe,ao as Re,ap as $e,af as oe,aP as Oe,aQ as De,a5 as ze,aa as le,ab as ne,ad as Fe,ae as Me,R as Ke,X as je,aA as Ae}from"./index-7fb70b78.js";import{E as Q}from"./card-27d98d03.js";import{E as se,a as ie}from"./form-item-b97c02fb.js";import{a as Je,E as qe}from"./col-72e1157d.js";import{a as Ge,_ as He}from"./select-29390fe3.js";import"./tag-24bfc22c.js";const Le=pe({modelValue:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},size:{type:String,validator:me},width:{type:[String,Number],default:""},inlinePrompt:{type:Boolean,default:!1},activeIcon:{type:Z},inactiveIcon:{type:Z},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},activeColor:{type:String,default:""},inactiveColor:{type:String,default:""},borderColor:{type:String,default:""},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:fe(Function)},id:String,tabindex:{type:[String,Number]},value:{type:[Boolean,String,Number],default:!1}}),Qe={[q]:c=>z(c)||M(c)||K(c),[G]:c=>z(c)||M(c)||K(c),[H]:c=>z(c)||M(c)||K(c)},We=["onClick"],Xe=["id","aria-checked","aria-disabled","name","true-value","false-value","disabled","tabindex","onKeydown"],Ye=["aria-hidden"],Ze=["aria-hidden"],ea=["aria-hidden"],L="ElSwitch",aa=R({name:L}),ta=R({...aa,props:Le,emits:Qe,setup(c,{expose:s,emit:i}){const l=c,u=Ue(),{formItem:f}=ve(),r=_e(),a=ge("switch");(t=>{t.forEach(_=>{Ie({from:_[0],replacement:_[1],scope:L,version:"2.3.0",ref:"https://element-plus.org/en-US/component/switch.html#attributes",type:"Attribute"},k(()=>{var O;return!!((O=u.vnode.props)!=null&&O[_[2]])}))})})([['"value"','"model-value" or "v-model"',"value"],['"active-color"',"CSS var `--el-switch-on-color`","activeColor"],['"inactive-color"',"CSS var `--el-switch-off-color`","inactiveColor"],['"border-color"',"CSS var `--el-switch-border-color`","borderColor"]]);const{inputId:v}=he(l,{formItemContext:f}),h=ye(k(()=>l.loading)),T=E(l.modelValue!==!1),w=E(),N=E(),B=k(()=>[a.b(),a.m(r.value),a.is("disabled",h.value),a.is("checked",g.value)]),m=k(()=>[a.e("label"),a.em("label","left"),a.is("active",!g.value)]),y=k(()=>[a.e("label"),a.em("label","right"),a.is("active",g.value)]),re=k(()=>({width:be(l.width)}));j(()=>l.modelValue,()=>{T.value=!0}),j(()=>l.value,()=>{T.value=!1});const W=k(()=>T.value?l.modelValue:l.value),g=k(()=>W.value===l.activeValue);[l.activeValue,l.inactiveValue].includes(W.value)||(i(q,l.inactiveValue),i(G,l.inactiveValue),i(H,l.inactiveValue)),j(g,t=>{var _;w.value.checked=t,l.validateEvent&&((_=f==null?void 0:f.validate)==null||_.call(f,"change").catch(O=>Ve()))});const $=()=>{const t=g.value?l.inactiveValue:l.activeValue;i(q,t),i(G,t),i(H,t),Te(()=>{w.value.checked=g.value})},X=()=>{if(h.value)return;const{beforeChange:t}=l;if(!t){$();return}const _=t();[ae(_),z(_)].includes(!0)||Ne(L,"beforeChange must return type `Promise<boolean>` or `boolean`"),ae(_)?_.then(Y=>{Y&&$()}).catch(Y=>{}):_&&$()},de=k(()=>a.cssVarBlock({...l.activeColor?{"on-color":l.activeColor}:null,...l.inactiveColor?{"off-color":l.inactiveColor}:null,...l.borderColor?{"border-color":l.borderColor}:null})),ue=()=>{var t,_;(_=(t=w.value)==null?void 0:t.focus)==null||_.call(t)};return we(()=>{w.value.checked=g.value}),s({focus:ue,checked:g}),(t,_)=>(d(),I("div",{class:C(e(B)),style:ee(e(de)),onClick:ke(X,["prevent"])},[S("input",{id:e(v),ref_key:"input",ref:w,class:C(e(a).e("input")),type:"checkbox",role:"switch","aria-checked":e(g),"aria-disabled":e(h),name:t.name,"true-value":t.activeValue,"false-value":t.inactiveValue,disabled:e(h),tabindex:t.tabindex,onChange:$,onKeydown:Ce(X,["enter"])},null,42,Xe),!t.inlinePrompt&&(t.inactiveIcon||t.inactiveText)?(d(),I("span",{key:0,class:C(e(m))},[t.inactiveIcon?(d(),b(e(D),{key:0},{default:n(()=>[(d(),b(A(t.inactiveIcon)))]),_:1})):V("v-if",!0),!t.inactiveIcon&&t.inactiveText?(d(),I("span",{key:1,"aria-hidden":e(g)},J(t.inactiveText),9,Ye)):V("v-if",!0)],2)):V("v-if",!0),S("span",{ref_key:"core",ref:N,class:C(e(a).e("core")),style:ee(e(re))},[t.inlinePrompt?(d(),I("div",{key:0,class:C(e(a).e("inner"))},[t.activeIcon||t.inactiveIcon?(d(),b(e(D),{key:0,class:C(e(a).is("icon"))},{default:n(()=>[(d(),b(A(e(g)?t.activeIcon:t.inactiveIcon)))]),_:1},8,["class"])):t.activeText||t.inactiveText?(d(),I("span",{key:1,class:C(e(a).is("text")),"aria-hidden":!e(g)},J(e(g)?t.activeText:t.inactiveText),11,Ze)):V("v-if",!0)],2)):V("v-if",!0),S("div",{class:C(e(a).e("action"))},[t.loading?(d(),b(e(D),{key:0,class:C(e(a).is("loading"))},{default:n(()=>[o(e(Se))]),_:1},8,["class"])):V("v-if",!0)],2)],6),!t.inlinePrompt&&(t.activeIcon||t.activeText)?(d(),I("span",{key:1,class:C(e(y))},[t.activeIcon?(d(),b(e(D),{key:0},{default:n(()=>[(d(),b(A(t.activeIcon)))]),_:1})):V("v-if",!0),!t.activeIcon&&t.activeText?(d(),I("span",{key:1,"aria-hidden":!e(g)},J(t.activeText),9,ea)):V("v-if",!0)],2)):V("v-if",!0)],14,We))}});var oa=Ee(ta,[["__file","/home/runner/work/element-plus/element-plus/packages/components/switch/src/switch.vue"]]);const la=Be(oa);const ce=c=>(Re("data-v-73966840"),c=c(),$e(),c),na=ce(()=>S("h3",null,"其他设置",-1)),sa={class:"config-card p-2"},ia={class:"config-tip"},ca=ce(()=>S("div",{class:"config-title my-2"},"开放注册",-1)),ra=R({__name:"OtherConfig",setup(c){const s=xe({openRegister:!0}),i={handleChange:async l=>{const u=await P.save("allow_register",l?"1":"0");F(u,"设置成功")},getConfig:async()=>{const l=await P.one("allow_register");l.code===200&&(s.openRegister=l.data.value==="1")}};return i.getConfig(),(l,u)=>{const f=te,r=Pe,a=la,p=Q;return d(),b(p,{class:"box-card cus-box-card",shadow:"hover"},{header:n(()=>[na]),default:n(()=>[S("div",sa,[o(r,{class:"box-item",effect:"dark",content:"是否允许用户自行注册账号？",placement:"top"},{default:n(()=>[S("span",ia,[o(f,{name:"questioncircle1",size:"12px"}),x(" 开放注册 ")])]),_:1}),ca,o(a,{onChange:i.handleChange,modelValue:e(s).openRegister,"onUpdate:modelValue":u[0]||(u[0]=v=>e(s).openRegister=v),"active-text":"开放","inactive-text":"禁止"},null,8,["onChange","modelValue"])])]),_:1})}}});const da=oe(ra,[["__scopeId","data-v-73966840"]]);class U{constructor(){}static getInstance(){return U.instance||(U.instance=new U),U.instance}email(s,i,l,u,f,r,a,p){return Oe.post("api/comm/send-email",{host:s,port:i,account:l,password:u,subject:f,nickname:r,content:a,receive:p})}}const ua=U.getInstance(),pa=S("h3",null,"邮件服务",-1),ma={class:"flex-sb w-100"},fa=R({__name:"EmailConfig",setup(c){const s=E(null),i=E(""),l=E(!1),u=E(!1),f={getConfig:async()=>{const r=await P.one("email_config");r.code===200&&(s.value=r.data.json)},handleSave:async()=>{u.value=!0;const r=await P.save("email_config",void 0,JSON.stringify(s.value));F(r),u.value=!1},testEmail:async()=>{if(s.value){l.value=!0;const r=await ua.email(s.value.host,parseInt(s.value.port),s.value.account,s.value.password,s.value.subject,s.value.nickname,"当您收到这封邮件，代表您的邮件服务配置成功！",i.value);F(r),l.value=!1}else ze.warning("请先完善邮件配置表单！")}};return f.getConfig(),(r,a)=>{const p=le,v=se,h=Je,T=qe,w=ne,N=ie,B=Q;return d(),b(B,{class:"box-card cus-box-card",shadow:"hover"},{header:n(()=>[pa]),default:n(()=>[e(s)?(d(),b(N,{key:0},{default:n(()=>[o(T,{gutter:15},{default:n(()=>[o(h,{span:24,md:12,lg:8},{default:n(()=>[o(v,{label:"服务地址"},{default:n(()=>[o(p,{modelValue:e(s).host,"onUpdate:modelValue":a[0]||(a[0]=m=>e(s).host=m),placeholder:"邮件服务器地址"},null,8,["modelValue"])]),_:1})]),_:1}),o(h,{span:24,md:12,lg:8},{default:n(()=>[o(v,{label:"服务端口"},{default:n(()=>[o(p,{type:"text",modelValue:e(s).port,"onUpdate:modelValue":a[1]||(a[1]=m=>e(s).port=m),placeholder:"邮件服务端口"},null,8,["modelValue"])]),_:1})]),_:1}),o(h,{span:24,md:12,lg:8},{default:n(()=>[o(v,{label:"发信账号"},{default:n(()=>[o(p,{modelValue:e(s).account,"onUpdate:modelValue":a[2]||(a[2]=m=>e(s).account=m),placeholder:"发信邮件账号"},null,8,["modelValue"])]),_:1})]),_:1}),o(h,{span:24,md:12,lg:8},{default:n(()=>[o(v,{label:"服务密码"},{default:n(()=>[o(p,{modelValue:e(s).password,"onUpdate:modelValue":a[3]||(a[3]=m=>e(s).password=m),placeholder:"邮件服务密码"},null,8,["modelValue"])]),_:1})]),_:1}),o(h,{span:24,md:12,lg:8},{default:n(()=>[o(v,{label:"邮件主题"},{default:n(()=>[o(p,{modelValue:e(s).subject,"onUpdate:modelValue":a[4]||(a[4]=m=>e(s).subject=m),placeholder:"邮件主题"},null,8,["modelValue"])]),_:1})]),_:1}),o(h,{span:24,md:12,lg:8},{default:n(()=>[o(v,{label:"邮件昵称"},{default:n(()=>[o(p,{modelValue:e(s).nickname,"onUpdate:modelValue":a[5]||(a[5]=m=>e(s).nickname=m),placeholder:"邮件昵称,请输入英文"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),S("div",ma,[o(p,{modelValue:e(i),"onUpdate:modelValue":a[6]||(a[6]=m=>De(i)?i.value=m:null),placeholder:"接收者邮箱"},null,8,["modelValue"]),o(w,{class:"ml-2",type:"warning",onClick:f.testEmail,loading:e(l)},{default:n(()=>[x(" 邮件服务测试 ")]),_:1},8,["onClick","loading"])])]),_:1})):V("",!0),o(w,{class:"mt-2",type:"primary",onClick:f.handleSave,loading:e(u)},{default:n(()=>[x(" 提交保存 ")]),_:1},8,["onClick","loading"])]),_:1})}}}),va=S("h3",null,"站点信息",-1),_a=R({__name:"SiteConfig",setup(c){const s=Fe(),{siteConfig:i}=Me(s),l=E(),u=E(!1),f={handleSave:async()=>{u.value=!0;const r=await P.save("site_config",void 0,JSON.stringify(s.siteConfig));F(r),u.value=!1},handleUpload:r=>{l.value=r,document.querySelector("#uploadRef").click()},uploadSuccess:r=>{Ae(s.siteConfig,l.value,r)}};return(r,a)=>{const p=le,v=se,h=te,T=Ge,w=ie,N=ne,B=He,m=Q;return d(),b(m,{class:"box-card cus-box-card",shadow:"hover"},{header:n(()=>[va]),default:n(()=>[e(i)?(d(),b(w,{key:0,style:{"max-width":"800px"}},{default:n(()=>[o(v,{label:"站点名字"},{default:n(()=>[o(p,{modelValue:e(i).site_name,"onUpdate:modelValue":a[0]||(a[0]=y=>e(i).site_name=y),placeholder:"站点名字"},null,8,["modelValue"])]),_:1}),o(v,{label:"站点logo"},{default:n(()=>[o(p,{type:"text",modelValue:e(i).logo,"onUpdate:modelValue":a[2]||(a[2]=y=>e(i).logo=y),placeholder:"请输入图片url或上传"},{append:n(()=>[o(h,{onClick:a[1]||(a[1]=y=>f.handleUpload("logo")),name:"upload2"})]),_:1},8,["modelValue"])]),_:1}),o(v,{label:"站点描述"},{default:n(()=>[o(p,{modelValue:e(i).description,"onUpdate:modelValue":a[3]||(a[3]=y=>e(i).description=y),placeholder:"站点描述"},null,8,["modelValue"])]),_:1}),o(v,{label:"系统描述"},{default:n(()=>[o(p,{modelValue:e(i).sysdesc,"onUpdate:modelValue":a[4]||(a[4]=y=>e(i).sysdesc=y),type:"textarea",placeholder:"站点描述",autosize:{minRows:3,maxRows:12}},null,8,["modelValue"])]),_:1}),o(v,{label:"站点标签"},{default:n(()=>[o(T,{modelValue:e(i).tags,"onUpdate:modelValue":a[5]||(a[5]=y=>e(i).tags=y),multiple:"",filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1,placeholder:"站点标签",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})):V("",!0),o(N,{class:"mt-2",type:"primary",onClick:f.handleSave,loading:e(u)},{default:n(()=>[x(" 提交保存 ")]),_:1},8,["onClick","loading"]),Ke(o(B,{accept:"image/*",onUpload:f.uploadSuccess},{default:n(()=>[o(N,{type:"primary",id:"uploadRef"},{default:n(()=>[x("点击上传")]),_:1})]),_:1},8,["onUpload"]),[[je,!1]])]),_:1})}}}),ga={};function ha(c,s){const i=_a,l=fa,u=da;return d(),I("div",null,[o(i),o(l,{class:"mt-2"}),o(u,{class:"mt-2"})])}const ka=oe(ga,[["render",ha]]);export{ka as default};
